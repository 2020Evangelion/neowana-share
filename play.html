<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>Neowana ì¬ìƒ</title>
  <script src="https://cdn.jsdelivr.net/npm/webtorrent@latest/webtorrent.min.js"></script>
  <style>
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;margin:24px}
    .hint{color:#666;font-size:14px}
  </style>
</head>
<body>
  <h2>ğŸ§ Neowana ì¬ìƒ</h2>
  <p class="hint">ì´ í˜ì´ì§€ëŠ” ë§ˆê·¸ë„· ë§í¬ë¡œ ìŠ¤íŠ¸ë¦¬ë° ì¬ìƒì„ ì‹œë„í•©ë‹ˆë‹¤.</p>
  <p id="status">ì´ˆê¸°í™” ì¤‘â€¦</p>
  <div id="player"></div>

  <script>
    const qs = new URLSearchParams(location.search);
    const magnet = qs.get('magnet');
    const status = document.getElementById('status');
    const player = document.getElementById('player');

    if (!magnet) {
      status.textContent = 'ë§ˆê·¸ë„· íŒŒë¼ë¯¸í„°ê°€ ì—†ìŠµë‹ˆë‹¤.';
    } else {
      status.textContent = 'í† ë ŒíŠ¸ ë©”íƒ€ë°ì´í„° ê°€ì ¸ì˜¤ëŠ” ì¤‘â€¦';
      const client = new WebTorrent();

      const trackers = [
        'wss://tracker.openwebtorrent.com',
        'wss://tracker.btorrent.xyz',
        'wss://tracker.webtorrent.dev'
      ];
      const href = magnet + trackers.map(t => '&tr=' + encodeURIComponent(t)).join('');

      client.add(href, torrent => {
        status.textContent = 'íŒŒì¼ ëª©ë¡ ë¡œë”©â€¦';
        const file = torrent.files.find(f =>
          /\.(mp3|wav|m4a|aac|ogg)$/i.test(f.name)
        ) || torrent.files[0];

        if (!file) {
          status.textContent = 'ì˜¤ë””ì˜¤ íŒŒì¼ì„ ì°¾ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.';
          return;
        }
        status.textContent = 'ìŠ¤íŠ¸ë¦¬ë° ì‹œì‘: ' + file.name;
        file.appendTo(player, { autoplay: true, controls: true }, (err) => {
          if (err) {
            status.textContent = 'í”Œë ˆì´ì–´ ì´ˆê¸°í™” ì‹¤íŒ¨: ' + err.message;
          }
        });
      });
    }
  </script>
</body>
</html>
